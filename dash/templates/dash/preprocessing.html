{% extends "dash/dash-base-temp.html" %}
{% block content %}
<!-- Page Heading -->
<div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Preprocessing and Models</h1>
    <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-danger shadow-sm">
        <i class="fas fa-binoculars fa-sm text-white-50"></i> Explore More Dataset </a>
</div>
<div class="row">
    <div class="col-xl-6 col-md-12 mb-4">
        <div class="card border-left-success bg-dark shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="h4 font-weight-bold text-success  mb-1">Selected File Name</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-100">{{ file_name }}</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-table fa-3x text-gray-100"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-6 col-md-12 mb-4">
        <div class="card border-left-success bg-dark shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="h4 font-weight-bold text-success  mb-1">Total Number Of Rows</div>
                        <div class="h5 mb-0 font-weight-bold text-gray-100">{{ row_count }}</div>
                    </div>
                    <div class="col-auto">
                        <i class="fas fa-calculator fa-3x text-gray-100"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="jumbotron bg-gray-300">
    <div class="mb-4">
        <h6 href="#" class="btn btn-primary btn-circle ">
            <span> 1 </span>
        </h6>
        <span class="h5 font-weight-bold text-dark "> DATA PREVIEW</span>
    </div>
    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable"  cellspacing="0">
        <thead>
        <tr>
            {% for columns in DataFrame %}
            <th>{{ columns | safe }}</th>
            {% endfor %}
        </tr>
        </thead>
        <tbody>
        {% for _, data in DataFrame.iterrows %}
        <tr>
            {% for value in data %}
            <td>{{ value | safe }}</td>
            {% endfor %}
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<h1>{{selecty}}</h1>
<div class="jumbotron bg-gray-300">
    <div class="mb-4">
        <h6 href="#" class="btn btn-primary btn-circle ">
            <span> 2 </span>
        </h6>
        <span class="h5 font-weight-bold text-dark "> DATA CLEANING AND IMPUTATION </span>
    </div>
    <form method="POST" action="." enctype="multipart/form-data">
        {% csrf_token %}
        <div class="container-fluid bg-dark text-white mb-4">
            <div class="row">
                <div class="form-group col-md-3">
                    <div class="fileUpload">
                        <label> Remove Special Characters : </label>
                        <select class="form-control" name="special" required>
                            <option value='no'>NOT APPLY</option>
                            <option value='Keep_dup'>Keep Special Characters</option>
                            <option value='Drop_dup'>Drop Special Characters</option>
                        </select>
                    </div>
                </div>
                <div class="form-group col-md-3">
                    <div class="fileUpload">
                        <label> Drop Duplicate Rows : </label>
                        <select class="form-control" name="duplicate_rows" required>
                            <option value='no'>NOT APPLY</option>
                            <option value='Keep_dup'>Keep Duplicate Rows</option>
                            <option value='Drop_dup'>Drop Duplicate Rows</option>
                        </select>
                    </div>
                </div>
                <div class="form-group col-md-3">
                    <div class="fileUpload">
                        <label> Missing values : </label>
                        <select class="form-control" name="missingvalues" required>
                            <option value='no'>NOT APPLY</option>
                            <option value='Keep_NAN'>Keep Na Values</option>
                            <option value='Drop_NAN'>Drop Na Values</option>
                        </select>
                    </div>
                </div>
                <div class="form-group col-md-3">
                    <div class="fileUpload ">
                        <label> Imputate NaN Values With : </label>
                        <select class="form-control" name="imputing" required>
                            <option value="no">NOT APPLY</option>
                            <option value='RDF'>Random Forest</option>
                            <option value='KNN'>KNN Imputer</option>
                            <option value='mean'>Mean</option>
                            <option value='median'>Median</option>
                            <option value='most_frequent'>Most frequent</option>
                            <option value='constant'>Constant</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>


        <div class="container-fluid mb-4">
            <div class="mb-4">
                <h6 href="#" class="btn btn-primary btn-circle ">
                    <span> 3 </span>
                </h6>
                <span class="h5 font-weight-bold text-dark "> LABEL AND ONE-HOT-ENCODING </span>
            </div>
            <table class="table table-md table-dark text-white" width="100%">
                <thead>
                <tr>
                    <th scope="col"> Column Name </th>
                    <th scope="col"> TYPE </th>
                    <th scope="col"> NAN COUNT </th>
                    <th scope="col"> DISTINCT COUNT </th>
                    <th scope="col"> SELECT ENCODER </th>
                    <th scope="col"> SELECT DEPENDENT VAR ONE 'Y' </th>
                </tr>
                </thead>
                <tbody>
                {% for key, value, value2, value3 in file_type.itertuples %}
                <tr>
                    <td> {{ key }} </td>
                    <td>
                        <select class="form-control col-md-8" name="coltype">
                            <option value={{key}}:{{value}}>{{ value }}</option>
                            {% if value == 'object' %}
                            <option value={{key}}:int64>int64</option>
                            <option value={{key}}:float64>float64</option>
                            {% endif %}
                            {% if value == 'int64' %}
                            <option value={{key}}:object>object</option>
                            <option value={{key}}:float64>float64</option>
                            {% endif %}
                            {% if value == 'float64' %}
                            <option value={{key}}:object>object</option>
                            <option value={{key}}:int64>int64</option>
                            {% endif %}
                        </select> </td>
                    <td> {{ value2 }} </td>
                    <td> {{ value3 }} </td>
                    <td>
                        <select class="form-control col-md-8" name="encoding">
                            <option value={{key}}:label_encoder> Label Encoder </option>
                            <option value={{key}}:column_encoder> One Hot Encoder </option>
                            <option value={{key}}:no_encoding> NOT APPLY </option>


                        </select>
                    </td>
                    <td>
                        <select class="form-control col-md-8" name="assvar">
                            <option value={{key}}:X> X </option>
                            <option value={{key}}:y> Y </option>
                            <option value={{key}}:no> Remove Column </option>
                        </select>
                    </td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>


        <div class="container-fluid mb-4">
            <div class="mb-4">
                <h6 href="#" class="btn btn-primary btn-circle ">
                    <span> 4 </span>
                </h6>
                <span class="h5 font-weight-bold text-dark "> FEATURE SCALING AND MODELS </span>
            </div>
            <div class="container-fluid bg-dark text-white mb-4">
                <div class="row">
                    <div class="form-group col-md-3">
                        <div class="fileUpload">
                            <label> Training Set Size % : </label>
                            <input class="form-control col-md-8" type="number" max="100" accuracy="1" min="0"
                                   name="trainingset_size" value="80" id="trainingset_size">
                        </div>
                    </div>
                    <div class="form-group col-md-3">
                        <div class="fileUpload ">
                            <label> Feature Scaling : </label>
                            <select class="form-control" name="scaling" required>
                                <option value="no">NOT APPLY</option>
                                <option value='SS_scale'>StandardScaler</option>
                                <option value='MMS_scale'>MinMaxScaler</option>
                                <option value='MAS_scale'>MaxAbsScaler</option>
                                <option value='RS_scale'>RobustScaler</option>
                                <option value='PTYJ_scale'> PowerTransformer Yeo-Jhonson</option>
                                <option value='PTBC_scale'>PowerTransformer Box-cox</option>
                                <option value='QTN_scale'> QuantileTransformer-normal</option>
                                <option value='QTU_scale'> QuantileTransformer-uniform</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group col-md-3">
                        <div class="fileUpload ">
                            <label> Normalization: </label>
                            <select class="form-control" name="norms" required>
                                <option value="no">NOT APPLY</option>
                                <option value='LAD_norm'>Least Absolute Deviation</option>
                                <option value='LSE_norm'>Least Square Error-DEFAULT</option>
                                <option value='M_norm'>Max Normalization</option>
                                <option value='MM_norm'>Min Max Normalization</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group col-md-3">
                        <div class="fileUpload ">
                            <label> Models Selection: </label>
                            <select class="form-control" name="models" required>
                                <option value='no'>NOT APPLY</option>
                                <option value='regress_models'>Regression Models</option>
                                <option value='class_models'>Classification Models</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-md-center mb-4">
            <input type="Submit" name="prepross_submit" class="btn btn-google btn-block col-md-4">
        </div>
    </form>
</div>


{% if graph %}
<div class="jumbotron bg-gray-300">
    <div class="mb-4">
        <h6 href="#" class="btn btn-primary btn-circle ">
            <span> 5 </span>
        </h6>
        <span class="h5 font-weight-bold text-dark "> SELECTED FEATURES AND PROPERTIES </span>
    </div>
    <div class="container-fluid bg-dark text-white mb-4">
        <table class="table table-dark">
            <thead>
            <tr>
                <th scope="col">SELECTED APPLICATIONS</th>
                <th scope="col">VALUES</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td> Duplicate Rows </td>
                <td> {{ duplicate_rows }} </td>
            </tr>
            <tr>
                <td> Missing Values </td>
                <td> {{ missing }} </td>
            </tr>
            <tr>
                <td> Imputation </td>
                <td> {{ imputing }} </td>
            </tr>
            <tr>
                <td> OneHot Encode </td>
                <td> {{ col_encode_names }} </td>
            </tr>
            <tr>
                <td> Label Encode </td>
                <td> {{ col_label_names }} </td>
            </tr>
            <tr>
                <td> No Encode </td>
                <td> {{ col_no_label_names }} </td>
            </tr>
            <tr>
                <td> X Features </td>
                <td> {{ xcols }} </td>
            </tr>
            <tr>
                <td> Y Features </td>
                <td> {{ ycol }} </td>
            </tr>
            <tr>
                <td> Traing Set </td>
                <td> {{ trainingset_s }} </td>
            </tr>
            <tr>
                <td> Test Set </td>
                <td> {{ testset_s }} </td>
            </tr>
            <tr>
                <td> Feature Scaling </td>
                <td> {{ scaling }} </td>
            </tr>
            <tr>
                <td> Normalization </td>
                <td> {{ norms }} </td>
            </tr>
            <tr>
                <td> Models </td>
                <td> {{ models }} </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>


<div class="jumbotron bg-gray-300">
    <div class="mb-4">
        <h6 href="#" class="btn btn-primary btn-circle ">
            <span> 2 </span>
        </h6>
        <span class="h5 font-weight-bold text-dark "> Models With Results </span>
    </div>
    <div class="container-fluid mb-2">
        <table class="table table-md table-dark text-white" width="100%">
            <tr>
                {% for value in modelnames %}
                <td>{{ value|safe }}</td>
                {% endfor %}
            </tr>
            <tr>
                {% for value in r2 %}
                <td class="bg-success text-dark font-weight-bold">{{ value|safe }}</td>
                {% endfor %}
            </tr>
        </table>
    </div>
</div>



<div class="jumbotron bg-gray-300">
    <div class="mb-4">
        <h6 href="#" class="btn btn-primary btn-circle ">
            <span> 7 </span>
        </h6>
        <span class="h5 font-weight-bold text-dark "> DATAFRAMES </span>
    </div>
    <div class="container-fluid mb-4">
        <ul class="nav nav-pills mb-3 " id="pills-tab" role="tablist">
            <li class="nav-item">
                <a class="nav-link  active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
                   aria-controls="pills-home" aria-selected="true"><span class="text-dark">Categorical Imputation</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link " id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
                   aria-controls="pills-profile" aria-selected="false"><span class="text-dark">Numerical Imputation</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link " id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab"
                   aria-controls="pills-contact" aria-selected="false"><span class="text-dark">All Encodings</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link " id="pills-contact-tab1" data-toggle="pill" href="#pills-contact1" role="tab"
                   aria-controls="pills-contact1" aria-selected="false"><span class="text-dark">X & Y DataFrames</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link " id="pills-contact-tab2" data-toggle="pill" href="#pills-contact2" role="tab"
                   aria-controls="pills-contact2" aria-selected="false"><span class="text-dark">Train & Test Sets</span></a>
            </li>
        </ul>
        <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable1"
                       cellspacing="0">
                    <thead>
                    <tr>
                        {% for columns in category_imputed %}
                        <th>{{ columns | safe }}</th>
                        {% endfor %}
                    </tr>
                    </thead>
                    <tbody>
                    {% for _, data in category_imputed.iterrows %}
                    <tr>
                        {% for value in data %}
                        <td>{{ value | safe }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                <div class="col mb-1">
                    <h4>Numerical Imputation on X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable2"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in x_cols %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in x_cols.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4>Numerical Imputation on Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable3"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in y_col %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in y_col.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
                <div class="col mb-1">
                    <h4>OneHotEncoding on X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable4"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in df_X1 %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in df_X1.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4>OneHotEncoding on Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable5"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in df_Y1 %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in df_Y1.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4>LabelEncoding on X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable6"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in df_X2 %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in df_X2.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4>LabelEncoding on Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable7"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in df_Y2 %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in df_Y2.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4>Not Applied  X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable8"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in df_X3 %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in df_X3.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4>Not Applied  Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable9"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in df_Y3 %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in df_Y3.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-contact1" role="tabpanel" aria-labelledby="pills-contact-tab1">
                <div class="col mb-1">
                    <h4>All X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable10"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in ALL_X_DF %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in ALL_X_DF.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4> Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable11"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in ALL_Y_DF %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in ALL_Y_DF.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-contact2" role="tabpanel" aria-labelledby="pills-contact-tab2">
                <div class="col mb-1">
                    <h4> Training Set Of X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable12"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in X_train %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in X_train.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4> Test Set Of X Feature Columns</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable13"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in X_test %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in X_test.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4> Training Set Of Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable14"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in y_train %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in y_train.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="col mb-1">
                    <h4> Test Set Of Y Feature Column</h4>
                    <table class="table table-responsive table-striped table-dark " width="100%" id="dataTable15"
                           cellspacing="0">
                        <thead>
                        <tr>
                            {% for columns in y_test %}
                            <th>{{ columns | safe }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {% for _, data in y_test.iterrows %}
                        <tr>
                            {% for value in data %}
                            <td>{{ value | safe }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="jumbotron bg-gray-300">
    <div class="mb-4">
        <h6 href="#" class="btn btn-primary btn-circle ">
            <span> 8 </span>
        </h6>
        <span class="h5 font-weight-bold text-dark "> BASIC COUNT GRAPHS ALL SELECTED ALL FEATURES </span>
    </div>
    <div class="container-fluid mb-2">
        <div class="row">
            {% for value in graph.values %}
            <div class="col-lg-4 col-xs-6 mb-2">
                {{ value|safe }}
            </div>
            {% endfor %}
        </div>
    </div>
</div>

{% endif %}
{% endblock content %}
